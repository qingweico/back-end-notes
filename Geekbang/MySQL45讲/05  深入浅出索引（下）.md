

回到主键索引树搜索的过程，我们称为回表

### 覆盖索引

由于覆盖索引可以减少树的搜索次数，显著提升查询性能，所以使用覆盖索引是一个常用的性能优化手段

联合索引在某些情况下可以用到覆盖索引，不再需要回表查整行记录，减少语句的执行时间。但是索引字段的维护总是有代价的，建立冗余索引来支持覆盖索引时就需要权衡考虑

### 最左前缀原则

B+ 树这种索引结构，可以利用索引的“最左前缀”，来定位记录

**索引项是按照索引定义里面出现的字段顺序排序的**

eg

<name, age> 联合索引，当使用 `like '张%`'， 可以使用上索引，但是 `like '%张`' 模糊查询索引无效

这个最左前缀可以是**联合索引的最左 N 个字段**，也可以是字符串索引的最左 M 个字符

### 索引下推

MySQL 5.6 引入的索引下推优化（index condition pushdown)， 可以在索引遍历过程中，对索引中包含的字段先做判断，直接过滤掉不满足条件的记录，减少回表次数

比如还是<name, age> 联合索引

```mysql
select * from tuser where name like '张%' and age=10 and ismale=1;
```

InnoDB 在 (name,age) 索引内部就判断了 age 是否等于 10，对于不等于 10 的记录，直接判断并跳过

**主键索引也是可以使用多个字段**

```mysql
CREATE TABLE `geek` (
  `a` int(11) NOT NULL,
  `b` int(11) NOT NULL,
  `c` int(11) NOT NULL,
  `d` int(11) NOT NULL,
  PRIMARY KEY (`a`,`b`),
  KEY `c` (`c`),
  KEY `ca` (`c`,`a`),
  KEY `cb` (`c`,`b`)
) ENGINE=InnoDB;
```

对于二级索引C，会默认和主键做联合索引。所以索引c的排序为cab，索引cb的排序顺序为cba。所以，结论是 ca 可以去掉，cb 需要保留

**不论是删除主键还是创建主键，都会将整个表重建**