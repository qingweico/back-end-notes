使用前缀索引的优势就是占用的空间会更小, 但这同时带来的损失是, 可能会增加额外的记录扫描次数

使用前缀索引, 定义好长度, 就可以做到既节省空间, 又不用额外增加太多的查询成本

建立索引时关注的是区分度, 区分度越高越好; 因为区分度越高, 意味着重复的键值越少; 因此, 我们可以通过统计索引上有多少个不同的值来判断要使用多长的前缀

使用前缀索引就用不上覆盖索引对查询性能的优化了, 这也是你在选择是否使用前缀索引时需要考虑的一个因素

索引选取的越长, 占用的磁盘空间就越大, 相同的数据页能放下的索引值就越少, 搜索的效率也就会越低

遇到前缀的区分度不够好的情况时:

- 第一种方式是使用倒序存储
- 第二种方式是使用 hash 字段

使用倒序存储和使用 hash 字段这两种方法的异同点

相同点：都不支持范围查询; 倒序存储的字段上创建的索引是按照倒序字符串的方式排序的, 已经没有办法利用索引方式查出身份证号码在[ID_X, ID_Y]的所有市民了; 同样地, hash 字段的方式也只能支持等值查询

不同点

- 从占用的额外空间来看, 倒序存储方式在主键索引上, 不会消耗额外的存储空间, 而 hash 字段方法需要增加一个字段; 当然, 倒序存储方式使用 4 个字节的前缀长度应该是不够的, 如果再长一点, 这个消耗跟额外这个 hash 字段也差不多抵消了
- 在 CPU 消耗方面, 倒序方式每次写和读的时候, 都需要额外调用一次 reverse 函数, 而 hash 字段的方式需要额外调用一次 crc32() 函数; 如果只从这两个函数的计算复杂度来看的话, reverse 函数额外消耗的 CPU 资源会更小些
- 从查询效率上看, 使用 hash 字段方式的查询性能相对更稳定一些; 因为 crc32 算出来的值虽然有冲突的概率, 但是概率非常小, 可以认为每次查询的平均扫描行数接近 1; 而倒序存储方式毕竟还是用的前缀索引的方式, 也就是说还是会增加扫描行数